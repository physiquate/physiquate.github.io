<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Physiquate Exam Portal</title>

<!-- ===== Basic CSS Styling ===== -->
<style>
  body { font-family: Arial, sans-serif; background-color: #f4f4f9; margin:0; padding:0; }
  header { position: sticky; top:0; background-color: #2196f3; color:white; padding:15px 20px; display:flex; justify-content:space-between; align-items:center; z-index:100; box-shadow:0 2px 6px rgba(0,0,0,0.2); }
  header h1 { font-size: 20px; margin:0; }
  .timer { font-weight:bold; }

  .container { max-width:800px; margin:40px auto; background-color:#fff; padding:30px; border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,0.1); }

  /* Form Inputs */
  .form-group { margin-bottom:15px; }
  .form-group label { display:block; font-weight:bold; margin-bottom:5px; }
  .form-group input { width:100%; padding:8px; border-radius:5px; border:1px solid #ccc; }

  /* Buttons */
  .btn, .nav-btn, .submit-btn { padding:12px 20px; border:none; border-radius:8px; cursor:pointer; font-size:16px; transition:0.3s; }
  .btn, .nav-btn { background-color:#2196f3; color:white; }
  .btn:hover, .nav-btn:hover { background-color:#1976d2; }
  .nav-btn:disabled { background-color:#90caf9; cursor:not-allowed; }
  .submit-btn { background-color:#4caf50; width:100%; margin-top:20px; color:white; }
  .submit-btn:hover { background-color:#388e3c; }

  /* Questions & Options */
  .question { display:none; }
  .question.active { display:block; }
  .question p { font-weight:bold; }
  .options label { display:block; padding:10px; margin:6px 0; background-color:#f9f9f9; border-radius:5px; cursor:pointer; transition:0.3s; }
  .options label:hover { background-color:#e0f7fa; }
  input[type="radio"] { margin-right:10px; }

  .navigation { margin-top:20px; display:flex; justify-content:space-between; }

  /* Result table */
  .result { display:none; margin-top:30px; background-color:#f1f8e9; padding:20px; border-radius:10px; }
  .result h2 { color:#2e7d32; margin-top:0; }
  table { width:100%; border-collapse:collapse; margin-top:15px; }
  th, td { border:1px solid #ccc; padding:10px; text-align:left; }
  th { background-color:#e0f7fa; }
  .correct-text { color:#2e7d32; font-weight:bold; }
  .incorrect-text { color:#c62828; font-weight:bold; }
</style>

<!-- ===== MathJax Library for LaTeX support ===== -->
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>

<!-- ===== Header with Timer ===== -->
<header>
  <h1>Physiquate Exam Portal</h1>
  <div class="timer" id="timer">00:00</div> <!-- Sticky timer displayed -->
</header>

<div class="container">

  <!-- ===== Step 1: Student Details ===== -->
  <div id="student-form">
    <h2>Enter Your Details</h2>
    <div class="form-group">
      <label for="student-name">Name</label>
      <input type="text" id="student-name" required>
    </div>
    <div class="form-group">
      <label for="student-email">Email ID</label>
      <input type="email" id="student-email" placeholder="example@domain.com" required>
    </div>
    <div class="form-group">
      <!-- ================================== EXAM TITLE CHANGE =============================================== -->
      <label for="exam-title">Exam Title</label>
      <input type="text" id="exam-title" value="Mathematical Physics Vector calculus - set 1" required>
      <!-- ================================== EXAM TITLE CHANGE =============================================== -->
    </div>
    <button class="btn" id="start-exam">Start Exam</button>
  </div>

  <!-- ===== Step 2: Exam Questions ===== -->
  <div id="exam" style="display:none;">
    <div class="navigation">
      <button type="button" class="nav-btn" id="prev">Previous</button>
      <button type="button" class="nav-btn" id="next">Next</button>
    </div>
    <button type="button" class="submit-btn" id="submit-btn" style="display:none;">Submit Exam</button>
  </div>

  <!-- ===== Step 3: Results ===== -->
  <div class="result" id="result">
    <h2>Exam Report</h2>
    <p id="student-info"></p>
    <p id="score-summary"></p>
    <table id="result-table">
      <thead>
        <tr>
          <th>Question</th>
          <th>Your Answer</th>
          <th>Correct Answer</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

</div>

<script>
document.addEventListener('DOMContentLoaded', function(){

  // =============================================== Step 1: Questions Array (can include LaTeX) ======================================================
  const questionsArray = [
    { q: "What is the speed of light in vacuum? c", options: ["$$3 x 10^8 m/s$$","$$1.5 x 10^8 m/s$$","$$3 x 10^6 m/s$$","$$1 x 10^9 m/s$$"], answer: 0 },
    { q: "Who proposed the theory of relativity?", options: ["Isaac Newton","Albert Einstein","Niels Bohr","James Clerk Maxwell"], answer: 1 },
    { q: "Electric current $I$ is measured in?", options: ["Volt","Ampere","Ohm","Watt"], answer: 1 },
    { q: "Solve $$\\int_0^1 x^2 dx$$", options: ["1/2","1/3","1","2/3"], answer: 1 } // Example math question
  ];
  // =============================================== Step 1: Questions Array (can include LaTeX) ======================================================

  // ===== Step 2: Generate Questions Dynamically =====
  const examDiv = document.getElementById('exam');
  questionsArray.forEach((item,index)=>{
    const qDiv = document.createElement('div'); // Question container
    qDiv.classList.add('question');
    if(index===0) qDiv.classList.add('active'); // first question active
    qDiv.id = `q${index+1}`;

    const p = document.createElement('p'); // Question text
    p.innerHTML = `${index+1}. ${item.q}`; // innerHTML allows LaTeX
    qDiv.appendChild(p);

    const optionsDiv = document.createElement('div'); // Options container
    optionsDiv.classList.add('options');
    item.options.forEach((opt,i)=>{
      const label = document.createElement('label');
      label.innerHTML = `<input type="radio" name="q${index+1}" value="${i}"> ${opt}`;
      optionsDiv.appendChild(label);
    });
    qDiv.appendChild(optionsDiv);

    // Insert question above navigation buttons
    const navigationDiv = examDiv.querySelector('.navigation');
    examDiv.insertBefore(qDiv, navigationDiv);
  });

  // ===== Step 3: Start Exam Logic =====
  const studentForm = document.getElementById('student-form');
  const startBtn = document.getElementById('start-exam');
  const timerDisplay = document.getElementById('timer');
  const studentInfo = document.getElementById('student-info');
  let countdown;

  startBtn.addEventListener('click', ()=>{
    const nameInput = document.getElementById('student-name');
    const emailInput = document.getElementById('student-email');
    const titleInput = document.getElementById('exam-title');

    const name = nameInput.value.trim();
    const email = emailInput.value.trim();
    const title = titleInput.value.trim();

    // Validation
    if(!name){ alert("Name required"); return; }
    const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if(!email || !emailPattern.test(email)){ alert("Valid email required"); return; }
    if(!title){ alert("Exam title required"); return; }

    studentInfo.innerHTML = `<strong>Name:</strong> ${name} | <strong>Email:</strong> ${email} | <strong>Exam:</strong> ${title}`;
    studentForm.style.display='none';
    examDiv.style.display='block';
       
    // ===== Save student details in LocalStorage =====
    const timestamp = new Date().toLocaleString();
    let examEntries = JSON.parse(localStorage.getItem('examEntries') || '[]');
    examEntries.push({ name: name, email: email, title: title, time: timestamp });
    localStorage.setItem('examEntries', JSON.stringify(examEntries));


    // ===================================================Timer (1 hour) ================================================================================
    let time = 60*60;
    countdown = setInterval(()=>{
      let minutes = Math.floor(time/60);
      let seconds = time%60;
      timerDisplay.textContent = `${minutes}:${seconds<10?'0'+seconds:seconds}`;
      time--;
      if(time<0){
        clearInterval(countdown);
        alert("Time is up! Exam submitted.");
        submitExam();
      }
    },1000);
     // ===================================================Timer (1 hour) ================================================================================
    // Render MathJax initially
    MathJax.typesetPromise();
  });

  // ===== Step 4: Navigation =====
  const questions = document.querySelectorAll('.question');
  const prevBtn = document.getElementById('prev');
  const nextBtn = document.getElementById('next');
  const submitBtn = document.getElementById('submit-btn');
  let current = 0;

  function showQuestion(index){
    questions.forEach((q,i)=> q.classList.toggle('active',i===index));
    prevBtn.disabled = index===0;
    nextBtn.style.display = index===questions.length-1?'none':'inline-block';
    submitBtn.style.display = index===questions.length-1?'block':'none';
    MathJax.typesetPromise(); // Re-render math for current question
  }

  nextBtn.addEventListener('click', ()=>{ if(current<questions.length-1){ current++; showQuestion(current); } });
  prevBtn.addEventListener('click', ()=>{ if(current>0){ current--; showQuestion(current); } });
  showQuestion(current);

  // ===== Step 5: Submit Exam =====
  const resultDiv = document.getElementById('result');
  const scoreSummary = document.getElementById('score-summary');
  const tbody = document.querySelector("#result-table tbody");

  submitBtn.addEventListener('click', submitExam);

  function submitExam(){
    clearInterval(countdown);
    let score=0;
    tbody.innerHTML='';

    questionsArray.forEach((item,index)=>{
      const qDiv = document.getElementById(`q${index+1}`);
      const selected = qDiv.querySelector('input[type="radio"]:checked');
      const userAnswer = selected ? parseInt(selected.value):-1;
      const status = userAnswer===item.answer?'Correct':'Incorrect';
      if(status==='Correct') score++;

      tbody.innerHTML += `<tr>
        <td>${item.q}</td>
        <td class="${status==='Correct'?'correct-text':'incorrect-text'}">
          ${userAnswer===-1?'Not Answered':item.options[userAnswer]}
        </td>
        <td class="correct-text">${item.options[item.answer]}</td>
        <td class="${status==='Correct'?'correct-text':'incorrect-text'}">${status}</td>
      </tr>`;
    });

    const percentage = ((score/questionsArray.length)*100).toFixed(2);
    let grade='';
    if(percentage>=90) grade='A+';
    else if(percentage>=80) grade='A';
    else if(percentage>=70) grade='B';
    else if(percentage>=60) grade='C';
    else grade='F';

    scoreSummary.innerHTML=`Score: ${score}/${questionsArray.length} | Percentage: ${percentage}% | Grade: ${grade}`;

    examDiv.style.display='none';
    resultDiv.style.display='block';
    resultDiv.scrollIntoView({behavior:"smooth"});

    // Re-render math in results
    MathJax.typesetPromise();
  }

});
</script>

</body>
</html>




